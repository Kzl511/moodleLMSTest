define(['jquery', 'core/ajax', 'core/notification'], function($, ajax, notification) {
    return {
        init: function() {
            var crs = $('[data-region="course-links"]').data('displaycourse');
            var promises = ajax.call([
                {
                    methodname: 'block_courselinks_get_course_modules',
                    args: { courseid: crs }
                }
            ]);

            promises[0].done(function(result) {
                console.log(result);

                var len = result.length;
                var $ul = $('<ul>', {
                    style: 'list-style-type:none;',
                    id: 'mod_list'
                }).appendTo('[data-region="course-links"]');

                for (let i = 0; i < len; i++) {
                    let { id, name, url, added, views } = result[i];
                    $ul.append(`<li>${id} - <a href="${url}">${name}</a> - ${added} (${views})</li>`);
                }

                if (len === 0) {
                    $ul.append('<li>No Records Found</li>');
                }

            }).fail(function(error) {
                console.log(error); 
                notification.addNotification({
                    type: 'error',
                    message: 'Error: ' + (error.message || 'Error displaying course modules.')
                });
            });
        }
    };
});
